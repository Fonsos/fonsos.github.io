define.experiment.Class("wysiwyg.common.components.basicmenu.editor.traits.BasicMenuDataHandler.CustomSiteMenu",function(a,b){var c=a,d=b;c.methods({_onMainMenuDataChange:d.remove(),_createMenuNonPersistentData:d.remove(),_removePagesEventListeners:d.remove(),_removeHiddenPagesEventListeners:d.remove(),_addPagesEventListeners:d.remove(),_addHiddenPagesEventListeners:d.remove()})}),define.experiment.Class("wysiwyg.common.components.basicmenu.editor.traits.MenuDomBuilder.CustomSiteMenu",function(a,b){var c=a;c.methods({buildItemList:function(){this._removeItemsDataChangeListeners(),this._build(),this._addItemsDataChangeListeners()},_addItemsDataChangeListeners:function(a){a=a||this._menuDataNP.get("items"),a.forEach(function(a){a.on(Constants.DataEvents.DATA_CHANGED,this,this._onMainMenuDataChange),this._addItemsDataChangeListeners(a.get("items"))}.bind(this))},_removeItemsDataChangeListeners:function(a){a=a||this._menuDataNP.get("items"),a.forEach(function(a){a.off(Constants.DataEvents.DATA_CHANGED,this,this._onMainMenuDataChange),this._removeItemsDataChangeListeners(a.get("items"))}.bind(this))}})}),define.experiment.component("Editor.wysiwyg.viewer.components.menus.DropDownMenu.Dropdownmenu",function(a,b){var c=a,d=b;c.panel({logic:"wysiwyg.common.components.dropdownmenu.editor.DropDownMenuPanel",skin:"wysiwyg.common.components.dropdownmenu.editor.skins.DropDownMenuPanelSkin"}),c.styles(3),c.helpIds({componentPanel:"/node/7794",advancedStyling:"/node/7771",chooseStyle:"/node/7771"}),c.toolTips({Menu_Settings_More_menu_button_ttid:{isMoreLess:!1,isDontShowAgain:!1,content:"[MENU_MORE_BUTTON_TT]",isPublished:!0,help:{isMoreHelp:!1,text:null,url:""}}}),c.resources(["W.Utils","W.Commands"]),c.binds(d.merge(["_onEditModeChange"])),c.traits(["wysiwyg.common.components.dropdownmenu.viewer.traits.MenuPropertiesHandler","wysiwyg.common.components.dropdownmenu.viewer.traits.MoreButtonHandler","wysiwyg.common.components.dropdownmenu.editor.traits.MenuDomBuilder","wysiwyg.common.components.dropdownmenu.editor.traits.MenuDataHandler"]),c.methods({initialize:d.after(function(){this.EDITOR_META_DATA={general:{settings:!0,design:!0},custom:[{label:"FPP_RENAME_PAGES_LABEL",command:"WEditorCommands.PageSettings",commandParameter:{BIsrc:"DropDownMenuFPP",parentPanel:"pagesPanel"}},{label:"FPP_NAVIGATE_LABEL",command:"WEditorCommands.Pages",commandParameter:{skinPart:"pagesPanel"}}],dblClick:{command:"WEditorCommands.Pages",commandParameter:"pagesPanel"}},this.resources.W.Commands.registerCommandAndListener("WPreviewCommands.WEditModeChanged",this,this._onEditModeChange)}),isRenderNeeded:d.around(function(a,b){var c=this._getRenderTriggers();return b.isInvalidated(c)||a(b)}),_getRenderTriggers:function(){return[this.INVALIDATIONS.PART_SIZE,"buttonsSizeChange"]},_onRender:function(a){this.parent(a),this._isFirstRender(a)&&(this._setDirectionToOpenSubMenu(),this._setLineHeight(this.getHeight())),this._debounceMarkWideSubmenus();var b=this._getTextAlignChange(a);b&&this._handleAlignTextState(b);var c=this._hasFontChange(a);c&&(this._initButtonsWidthMap(),this._arrangeMenuAccordingToNewWidth(),this._setLineHeight(this.getHeight()));var d=this._getWidthChange(a);d&&(this._arrangeMenuAccordingToNewWidth(d),this._currentWidth=d);var e=this._getHeightChange(a);e&&(this._currentHeight=e);var f=this._getButtonsSizeChange(a);f&&!d&&this._handleButtonsSizeChange(f);var g=this._getPropertyChange(a);if(g){var h=g.field&&g.value[g.field];this.setMenuProperty(g.dataItem,g.field,h),this._setLineHeight(this.getHeight())}var i=this._getMenuContainerWidthChange(a);i&&(this._handleMenuContainerSizeChange(),this._arrangeMenuAccordingToNewWidth());var j=this._getMenuContainerHeightChange(a);j&&!this._skinParts.hasExtraDecorations&&this.setHeight(j),a.data.invalidations.isInvalidated([this.INVALIDATIONS.POSITION])&&this._setDirectionToOpenSubMenu()},_hasFontChange:function(a){var b=a.data.invalidations.getInvalidationByType(this.INVALIDATIONS.STYLE_PARAM_CHANGE),c=b&&b[0];return c&&c.properties&&"font"===c.properties.fnt},_getWidthChange:function(a){var b=a.data.invalidations.getInvalidationByType(this.INVALIDATIONS.WIDTH_REQUEST),c=b&&b[0];return c&&c.width},_getHeightChange:function(a){var b=a.data.invalidations.getInvalidationByType(this.INVALIDATIONS.HEIGHT_REQUEST),c=b&&b[0];return c&&c.height},_getButtonsSizeChange:function(a){var b=a.data.invalidations.getInvalidationByType("buttonsSizeChange"),c=b&&b[0];return c?(c.width!==this._currentWidth||c.height>this._currentHeight)&&c:void 0},_getTextAlignChange:function(a){var b=a.data.invalidations._invalidations.dataChange,c=b&&b[0];return c&&"alignText"===c.field?c.value.alignText:null},_getMenuContainerWidthChange:function(a){var b=a.data.invalidations.getInvalidationByType(this.INVALIDATIONS.PART_SIZE),c=!!this._getWidthChange(a);return!c&&b&&b[0]&&b[0].current.width!==b[0].old.width&&b[0].current.width},_getMenuContainerHeightChange:function(a){var b=a.data.invalidations.getInvalidationByType(this.INVALIDATIONS.PART_SIZE),c=!!this._getHeightChange(a);return!c&&b&&b[0]&&b[0].current.height!==b[0].old.height&&b[0].current.height},_arrangeMenuAccordingToNewWidth:function(a){this._moveButtonsToAndFromMoreSubMenuIfNeeded(a),this._updateComponentAccordingToLayoutAffectingProperties(),1===this._menuContainer.getChildren().length&&this._setMenuMinWidth()},_handleButtonsSizeChange:function(a){a.width&&this.setWidth(this._currentWidth),a.height&&this.setHeight(a.height)},_handleMenuContainerSizeChange:function(){var a,b;_.forEach(this._menuContainer.getElements("li"),function(c){a=this.getLabelElement(c),b=this._buttonsWidthMap[this._getButtonIdentifier(c)],this._updateButtonsWidthMap(c,a.getWidth()+(b?b.extraWidth:0))},this)},_handleAlignTextState:function(a){this.setState("text-align-"+a)},_updateMenuDimensionsAccordingToButtons:function(){var a={},b=this._getMenuWidthChange(),c=this._getMenuHeightChange();b&&(a.width=b),c&&(a.height=c),_.isEmpty(a)||this._handleButtonsSizeChange(a)},_updateComponentAccordingToLayoutAffectingProperties:function(){var a=this.getComponentProperties(),b=["alignButtons","alignText","sameWidthButtons","stretchButtonsToMenuWidth"];b.forEach(function(b){this.setMenuProperty(a,b,a.get(b))},this)},_getViewNodeByHref:function(a){return _.first(this._getViewNodesByHref(a))},_getMenuWidthChange:function(){var a=this._menuContainer.getChildren(),b=this._getButtonsTotalWidth(a),c=this.getWidth();return b>c||b+2*a.length<c&&this._properties.get("stretchButtonsToMenuWidth")?b:null},_getMenuHeightChange:function(){var a=this.getLabelElement(this._menuContainer.getFirst()).getHeight();return a>this._currentHeight?a:null},_updateButtonsWidthMap:function(a,b,c){var d=this._getButtonIdentifier(a);this._buttonsWidthMap[d]||(this._buttonsWidthMap[d]={}),this._buttonsWidthMap[d].minWidth=b,c&&(this._buttonsWidthMap[d].extraWidth=c)},exterminate:function(){this.resources.W.Viewer.removeEvent("pageTransitionStarted",this._onSelectedPageChanged),this.parent()},_onEditModeChange:function(a){"PREVIEW"===a&&this._setDirectionToOpenSubMenu()}})}),define.experiment.newClass("wysiwyg.common.components.dropdownmenu.editor.traits.MenuDataHandler.Dropdownmenu",function(a){var b=a;b.inherits("wysiwyg.common.components.dropdownmenu.viewer.traits.MenuDataHandler"),b.methods({_onMainMenuDataChange:function(){this._updateMenuData();var a=this._menuContainer.getElements("li").length;this._isMoreButtonVisible&&(a--,this._resetMoreButton()),this.resources.W.Utils.callLater(function(){this.buildItemList();var b=this._menuContainer.getElements("li").length;b>a?this._initButtonsWidthMap(this._menuContainer.getElements("li")):this._updateComponentAccordingToLayoutAffectingProperties(),this._arrangeMenuAccordingToNewWidth()},[],this)},_updateMenuData:function(){this._menuDataNP=this._createMenuNonPersistentData(this._mainMenuData),this._updateHrefToDataNodeMap()},_handlePageDataChange:function(a){var b,c=a.data.dataItem,d=a.data.field,e=c.get(d);if("hidePage"===d){if(this.buildItemList(),0==e){b=this._getViewNodeByHref(c.get("id"));var f=this.getLabelElement(b),g=this._buttonsWidthMap[this._getButtonIdentifier(b)];this._updateButtonsWidthMap(b,f.getWidth()+(g?g.extraWidth:0))}this._updateComponentAccordingToLayoutAffectingProperties()}else if("title"===d){var h=this._hrefToDataNodeMap["#"+c.get("id")];h.set("label",e),c.get("hidePage")||(b=this._getViewNodeByHref(c.get("id")),this._handleButtonLabelChange(e,b))}},_handleButtonLabelChange:function(a,b){var c=this.getLabelElement(b);c.set("text",a),this._setMenuWidthAfterLabelChange(b,c)},_setMenuWidthAfterLabelChange:function(a,b){var c=this._buttonsWidthMap[this._getButtonIdentifier(a)];this._updateButtonsWidthMap(a,b.getWidth()+(c?c.extraWidth:0)),this.setWidth(this._currentWidth)}})}),define.experiment.newClass("wysiwyg.common.components.dropdownmenu.editor.traits.MenuDomBuilder.Dropdownmenu",function(a){var b=a;b.inherits("wysiwyg.common.components.dropdownmenu.viewer.traits.MenuDomBuilder"),b.methods({buildItemList:function(){var a=this._data.get("menuRef");"#MAIN_MENU"===a||"MAIN_MENU"===a?(this._removePagesEventListeners(),this._removeHiddenPagesEventListeners(),this._build(),this._addPagesEventListeners(),this._addHiddenPagesEventListeners()):this._build()},_build:function(){this._menuContainer.set("html",""),this._buildMenuDomAccordingToData(this._menuDataNP.get("items"),this._menuContainer),this._renderLinks(this._menuContainer.getChildren(),this._menuDataNP.get("items")),this._setMenuMinHeight(),this._setSelectedButton(this.getSelectedLinkId()),this._menuContainer.on("click",this,this._onMenuClicked),this._debounceMarkWideSubmenus()}})}),define.experiment.Class("wysiwyg.common.components.dropdownmenu.viewer.traits.MenuPropertiesHandler.Dropdownmenu",function(a,b){var c=a,d=b;c.methods({setMenuProperty:d.after(function(a,b,c){switch(b){case"moreButtonLabel":this._isMoreButtonVisible&&this._handleMoreButtonLabelProperty(c)}})})}),define.experiment.component("Editor.wysiwyg.common.components.imagebutton.viewer.ImageButton.ProportionalScaling",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:d.merge({general:{proportionalResize:!0}})})}),define.experiment.component("Editor.wysiwyg.common.components.onlineclock.viewer.OnlineClock.OnlineClock",function(a,b){var c=a,d=b;c.resources(["W.Config","W.Utils"]),c.panel({logic:"wysiwyg.common.components.onlineclock.editor.OnlineClockPanel",skin:"wysiwyg.common.components.onlineclock.editor.skins.OnlineClockPanelSkin"}),c.styles(1),c.helpIds({componentPanel:""}),c.statics({"12_hour_clock_countries":["CAN","GBR","PHL","USA"],EDITOR_META_DATA:{general:{settings:!0,design:!0}}}),c.methods({initialize:d.after(function(){this._resizableSides=[],this._rotatable=!0}),_onFirstRender:d.after(function(){""===this.getComponentProperties().get("timeFormat")&&(~this["12_hour_clock_countries"].indexOf(this.resources.W.Utils.getCountryCode())?this.getComponentProperties().set("timeFormat","full_12"):this.getComponentProperties().set("timeFormat","full_24")),this._resetSize()}),_onEachRender:d.before(function(a){this.resources.W.Config.env.$isEditorFrame||(a.data.invalidations.isInvalidated([this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.PROPERTIES_CHANGE,this.INVALIDATIONS.STYLE_PARAM_CHANGE,this.INVALIDATIONS.SKIN_CHANGE])?this._resetSize():a.data.invalidations.isInvalidated([this.INVALIDATIONS.MEASURED_SIZE_DIFFERS_FROM_REQUESTED])&&this._updateSize())}),_resetSize:function(){this.setWidth(30),this.setHeight(15)},_updateSize:function(){var a=this.getMeasure();this.setWidth(a.width),this.setHeight(a.height)}})}),define.experiment.newComponent("Editor.wysiwyg.common.components.rssbutton.viewer.RSSButton.BlogRss.New",function(a){var b=a;b.panel({logic:"wysiwyg.common.components.rssbutton.editor.RSSButtonPanel",skin:"wysiwyg.common.components.rssbutton.editor.skins.RSSButtonPanelSkin"}),b.styles(1),b.helpIds({componentPanel:"/node/21349999"}),b.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1}}})}),define.experiment.component("Editor.wysiwyg.common.components.verticalmenu.viewer.VerticalMenu.CustomSiteMenu",function(a,b){var c=a,d=b;c.methods({_onRender:d.after(function(a){this._getRefIdDataChange(a)&&(this._handleFirstDataChange(),this._handleSkinChange())}),_getRefIdDataChange:function(a){var b=a.data.invalidations.getInvalidationByType(this.INVALIDATIONS.DATA_CHANGE),c=b&&b[0];return c&&"menuRef"===c.field}})}),define.experiment.Class("wysiwyg.common.components.verticalmenu.editor.traits.MenuDataHandler.CustomSiteMenu",function(a){var b=a;b.methods({_onMainMenuDataChange:function(){this._menuDataNP=this._createMenuNonPersistentData(this._mainMenuData),this.buildItemList(),this._setItemsHeight(!0)}})}),define.experiment.component("Editor.wysiwyg.common.components.weather.viewer.Weather.Weather.New",function(a){var b=a;b.panel({logic:"wysiwyg.common.components.weather.editor.WeatherPanel",skin:"wysiwyg.common.components.weather.editor.skins.WeatherPanelSkin"}),b.styles(2),b.helpIds({componentPanel:"/node/18990",chooseStyle:""}),b.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0}}}),b.methods({})});